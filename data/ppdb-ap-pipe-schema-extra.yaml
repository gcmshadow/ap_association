# Extra schema definitions compared to `cat` schema used by L1DB implementation.

# DiaObject needs a special column for time of last seen DiaSource,
# validityEnd should be allowed to have NULL (for +Infinity)
table: DiaObject
columns:
- name: lastNonForcedSource
  type: DATETIME
  nullable: false
  description: Last time when non-forced DIASource was seen for this object.
- name: validityEnd
  type: DATETIME
  nullable: true
  description: Time when validity of this diaObject ends.
  default: null
- name: nDiaSources
  type: INT
  nullable: false
  description: Total number of DiaSources associated with this DiaObject.

- name: uPSFluxMedian
  type: FLOAT
  nullable: true
  description: Median u band flux.
- name: uPSFluxMAD
  type: FLOAT
  nullable: true
  description: Median absolute deviation u band fluxes.
- name: uPSFluxSkew
  type: FLOAT
  nullable: true
  description: Skewness of the u band fluxes.
- name: uPSFluxPercentile05
  type: FLOAT
  nullable: true
  description: Value at the 5% percentile of the u band fluxes.
- name: uPSFluxPercentile25
  type: FLOAT
  nullable: true
  description: Value at the 25% percentile of the u band fluxes.
- name: uPSFluxPercentile75
  type: FLOAT
  nullable: true
  description: Value at the 75% percentile of the u band fluxes.
- name: uPSFluxPercentile95
  type: FLOAT
  nullable: true
  description: Value at the 95% percentile of the u band fluxes.
- name: uPSFluxMin
  type: FLOAT
  nullable: true
  description: Minimum observed u band fluxes.
- name: uPSFluxMax
  type: FLOAT
  nullable: true
  description: Maximum observed u band fluxes.
- name: uPSFluxStetsonJ
  type: FLOAT
  nullable: true
  description: StetsonJ statistic for the u band fluxes.
- name: uPSFluxLinearSlope
  type: FLOAT
  nullable: true
  description: Linear best fit slope of the u band fluxes.
- name: uPSFluxLinearIntercept
  type: FLOAT
  nullable: true
  description: Linear best fit Intercept of the u band fluxes.
- name: uPSFluxMaxSlope
  type: FLOAT
  nullable: true
  description: Maximum slope between u band flux obsevations max(delta_flux/delta_time)
- name: uPSFluxErrMean
  type: FLOAT
  nullable: true
  description: Mean of the u band flux errors.

- name: gPSFluxMedian
  type: FLOAT
  nullable: true
  description: Median g band flux.
- name: gPSFluxMAD
  type: FLOAT
  nullable: true
  description: Median absolute deviation g band fluxes.
- name: gPSFluxSkew
  type: FLOAT
  nullable: true
  description: Skewness of the g band fluxes.
- name: gPSFluxPercentile05
  type: FLOAT
  nullable: true
  description: Value at the 5% percentile of the g band fluxes.
- name: gPSFluxPercentile25
  type: FLOAT
  nullable: true
  description: Value at the 25% percentile of the g band fluxes.
- name: gPSFluxPercentile75
  type: FLOAT
  nullable: true
  description: Value at the 75% percentile of the g band fluxes.
- name: gPSFluxPercentile95
  type: FLOAT
  nullable: true
  description: Value at the 95% percentile of the g band fluxes.
- name: gPSFluxMin
  type: FLOAT
  nullable: true
  description: Minimum observed g band fluxes.
- name: gPSFluxMax
  type: FLOAT
  nullable: true
  description: Maximum observed g band fluxes.
- name: gPSFluxStetsonJ
  type: FLOAT
  nullable: true
  description: StetsonJ statistic for the g band fluxes.
- name: gPSFluxLinearSlope
  type: FLOAT
  nullable: true
  description: Linear best fit slope of the g band fluxes.
- name: gPSFluxLinearIntercept
  type: FLOAT
  nullable: true
  description: Linear best fit Intercept of the g band fluxes.
- name: gPSFluxMaxSlope
  type: FLOAT
  nullable: true
  description: Maximum slope between g band flux obsevations max(delta_flux/delta_time)
- name: gPSFluxErrMean
  type: FLOAT
  nullable: true
  description: Mean of the g band flux errors.
- name: rPSFluxMedian
  type: FLOAT
  nullable: true
  description: Median r band flux.
- name: rPSFluxMAD
  type: FLOAT
  nullable: true
  description: Median absolute deviation r band fluxes.
- name: rPSFluxSkew
  type: FLOAT
  nullable: true
  description: Skewness of the r band fluxes.
- name: rPSFluxPercentile05
  type: FLOAT
  nullable: true
  description: Value at the 5% percentile of the r band fluxes.
- name: rPSFluxPercentile25
  type: FLOAT
  nullable: true
  description: Value at the 25% percentile of the r band fluxes.
- name: rPSFluxPercentile75
  type: FLOAT
  nullable: true
  description: Value at the 75% percentile of the r band fluxes.
- name: rPSFluxPercentile95
  type: FLOAT
  nullable: true
  description: Value at the 95% percentile of the r band fluxes.
- name: rPSFluxMin
  type: FLOAT
  nullable: true
  description: Minimum observed r band fluxes.
- name: rPSFluxMax
  type: FLOAT
  nullable: true
  description: Maximum observed r band fluxes.
- name: rPSFluxStetsonJ
  type: FLOAT
  nullable: true
  description: StetsonJ statistic for the r band fluxes.
- name: rPSFluxLinearSlope
  type: FLOAT
  nullable: true
  description: Linear best fit slope of the r band fluxes.
- name: rPSFluxLinearIntercept
  type: FLOAT
  nullable: true
  description: Linear best fit Intercept of the r band fluxes.
- name: rPSFluxMaxSlope
  type: FLOAT
  nullable: true
  description: Maximum slope between r band flux obsevations max(delta_flux/delta_time)
- name: rPSFluxErrMean
  type: FLOAT
  nullable: true
  description: Mean of the r band flux errors.
- name: iPSFluxMedian
  type: FLOAT
  nullable: true
  description: Median i band flux.
- name: iPSFluxMAD
  type: FLOAT
  nullable: true
  description: Median absolute deviation i band fluxes.
- name: iPSFluxSkew
  type: FLOAT
  nullable: true
  description: Skewness of the i band fluxes.
- name: iPSFluxPercentile05
  type: FLOAT
  nullable: true
  description: Value at the 5% percentile of the i band fluxes.
- name: iPSFluxPercentile25
  type: FLOAT
  nullable: true
  description: Value at the 25% percentile of the i band fluxes.
- name: iPSFluxPercentile75
  type: FLOAT
  nullable: true
  description: Value at the 75% percentile of the i band fluxes.
- name: iPSFluxPercentile95
  type: FLOAT
  nullable: true
  description: Value at the 95% percentile of the i band fluxes.
- name: iPSFluxMin
  type: FLOAT
  nullable: true
  description: Minimum observed i band fluxes.
- name: iPSFluxMax
  type: FLOAT
  nullable: true
  description: Maximum observed i band fluxes.
- name: iPSFluxStetsonJ
  type: FLOAT
  nullable: true
  description: StetsonJ statistic for the i band fluxes.
- name: iPSFluxLinearSlope
  type: FLOAT
  nullable: true
  description: Linear best fit slope of the i band fluxes.
- name: iPSFluxLinearIntercept
  type: FLOAT
  nullable: true
  description: Linear best fit Intercept of the i band fluxes.
- name: iPSFluxMaxSlope
  type: FLOAT
  nullable: true
  description: Maximum slope between i band flux obsevations max(delta_flux/delta_time)
- name: iPSFluxErrMean
  type: FLOAT
  nullable: true
  description: Mean of the i band flux errors.
- name: zPSFluxMedian
  type: FLOAT
  nullable: true
  description: Median z band flux.
- name: zPSFluxMAD
  type: FLOAT
  nullable: true
  description: Median absolute deviation z band fluxes.
- name: zPSFluxSkew
  type: FLOAT
  nullable: true
  description: Skewness of the z band fluxes.
- name: zPSFluxPercentile05
  type: FLOAT
  nullable: true
  description: Value at the 5% percentile of the z band fluxes.
- name: zPSFluxPercentile25
  type: FLOAT
  nullable: true
  description: Value at the 25% percentile of the z band fluxes.
- name: zPSFluxPercentile75
  type: FLOAT
  nullable: true
  description: Value at the 75% percentile of the z band fluxes.
- name: zPSFluxPercentile95
  type: FLOAT
  nullable: true
  description: Value at the 95% percentile of the z band fluxes.
- name: zPSFluxMin
  type: FLOAT
  nullable: true
  description: Minimum observed z band fluxes.
- name: zPSFluxMax
  type: FLOAT
  nullable: true
  description: Maximum observed z band fluxes.
- name: zPSFluxStetsonJ
  type: FLOAT
  nullable: true
  description: StetsonJ statistic for the z band fluxes.
- name: zPSFluxLinearSlope
  type: FLOAT
  nullable: true
  description: Linear best fit slope of the z band fluxes.
- name: zPSFluxLinearIntercept
  type: FLOAT
  nullable: true
  description: Linear best fit Intercept of the z band fluxes.
- name: zPSFluxMaxSlope
  type: FLOAT
  nullable: true
  description: Maximum slope between z band flux obsevations max(delta_flux/delta_time)
- name: zPSFluxErrMean
  type: FLOAT
  nullable: true
  description: Mean of the z band flux errors.
- name: yPSFluxMedian
  type: FLOAT
  nullable: true
  description: Median y band flux.
- name: yPSFluxMAD
  type: FLOAT
  nullable: true
  description: Median absolute deviation y band fluxes.
- name: yPSFluxSkew
  type: FLOAT
  nullable: true
  description: Skewness of the y band fluxes.
- name: yPSFluxPercentile05
  type: FLOAT
  nullable: true
  description: Value at the 5% percentile of the y band fluxes.
- name: yPSFluxPercentile25
  type: FLOAT
  nullable: true
  description: Value at the 25% percentile of the y band fluxes.
- name: yPSFluxPercentile75
  type: FLOAT
  nullable: true
  description: Value at the 75% percentile of the y band fluxes.
- name: yPSFluxPercentile95
  type: FLOAT
  nullable: true
  description: Value at the 95% percentile of the y band fluxes.
- name: yPSFluxMin
  type: FLOAT
  nullable: true
  description: Minimum observed y band fluxes.
- name: yPSFluxMax
  type: FLOAT
  nullable: true
  description: Maximum observed y band fluxes.
- name: yPSFluxStetsonJ
  type: FLOAT
  nullable: true
  description: StetsonJ statistic for the y band fluxes.
- name: yPSFluxLinearSlope
  type: FLOAT
  nullable: true
  description: Linear best fit slope of the y band fluxes.
- name: yPSFluxLinearIntercept
  type: FLOAT
  nullable: true
  description: Linear best fit Intercept of the y band fluxes.
- name: yPSFluxMaxSlope
  type: FLOAT
  nullable: true
  description: Maximum slope between y band flux obsevations max(delta_flux/delta_time)
- name: yPSFluxErrMean
  type: FLOAT
  nullable: true
  description: Mean of the y band flux errors.

---
# DiaObjectLast uses the same columns as DiaObject but has different index
table: DiaObjectLast
indices:
- name: PK_DiaObjectLast
  columns:
  - pixelId
  - diaObjectId
  type: PRIMARY
- name: IDX_DiaObjectLast_diaObjectId
  columns:
  - diaObjectId
  type: INDEX
- name: nDiaSources
  type: INT
  nullable: false
  description: Total number of DiaSources associated with this DiaObject.

---
# Special PK index for DiaObject table with spacial column being first
# (should provide better locality)
table: DiaObjectIndexHtmFirst
indices:
- name: PK_DiaObject
  columns:
  - pixelId
  - diaObjectId
  - validityStart
  type: PRIMARY
- name: IDX_DiaObject_diaObjectId
  columns:
  - diaObjectId
  type: INDEX

---
# Added columns for DIASource table for use in ap_association.
table: DiaSource
columns:
- name: filterName
  type: CHAR
  nullable: false
  description: Name of stored filter.
- name: filterId
  type: INT
  nullable: false
  description: id number of stored filter.
